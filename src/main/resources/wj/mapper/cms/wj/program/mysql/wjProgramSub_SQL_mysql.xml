<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="WjProgramSubDAO">

    <select id="selectProgramSub"
            parameterType="wj.com.cms.wj.program.vo.WjProgramSubVO"
            resultType="wj.com.cms.wj.program.vo.WjProgramSubVO">
        SELECT
             PS.PROGRAM_SUB_SNO
            ,PS.FESTIVITY_ID
            ,PS.PROGRAM_SNO
            ,PS.TITLE
            ,PS.MEMO
            ,PS.LEADER_YN
            ,PS.ORDER_CNT
            ,PS.ATCH_FILE_ID
            ,PS.USE_YN
            ,PS.DELETE_YN
            ,PS.REG_DT
            ,PS.REG_ID
            ,PS.MOD_DT
            ,PS.MOD_ID
        FROM WJ_PROGRAM_SUB PS
        WHERE 1=1
          AND PS.PROGRAM_SUB_SNO =#{programSubSno}
    </select>
    <select id="selectProgramSubTotalCount"
        parameterType="wj.com.cms.wj.program.vo.WjProgramSubVO"
        resultType="int">
        SELECT COUNT(*) totcnt
        FROM WJ_PROGRAM_SUB PS
        WHERE 1=1
          AND PS.PROGRAM_SNO = ${programSno}
          AND PS.DELETE_YN = 'N'

    </select>
    <select id="selectProgramSubList"
        parameterType="wj.com.cms.wj.program.vo.WjProgramSubVO"
        resultType="wj.com.cms.wj.program.vo.WjProgramSubVO">
        SELECT
             PS.PROGRAM_SUB_SNO
            ,PS.FESTIVITY_ID
            ,PS.PROGRAM_SNO
            ,PS.TITLE
            ,PS.MEMO
            ,PS.LEADER_YN
            ,PS.ORDER_CNT
            ,PS.ATCH_FILE_ID
            ,PS.USE_YN
            ,PS.DELETE_YN
            ,PS.REG_DT
            ,PS.REG_ID
            ,PS.MOD_DT
            ,PS.MOD_ID
        FROM WJ_PROGRAM_SUB PS
        WHERE 1=1
        AND PS.PROGRAM_SNO = ${programSno}
        AND PS.DELETE_YN = 'N'
        <if test="searchCondition == 1">
            AND PS.TITLE LIKE CONCAT('%', #{searchKeyword}, '%')
        </if>
        <if test="searchCondition ==2">
            AND PS.MEMO LIKE CONCAT('%',#{searchKeyword}, '%')
        </if>
        LIMIT #{recordCountPerPage} OFFSET #{firstIndex}

    </select>

    <insert id="insertProgramSub">
        <![CDATA[
            INSERT INTO WJ_PROGRAM_SUB(
                 PROGRAM_SUB_SNO
                ,FESTIVITY_ID
                ,PROGRAM_SNO
                ,TITLE
                ,MEMO
                ,LEADER_YN
                ,ORDER_CNT
                ,ATCH_FILE_ID
                ,USE_YN
                ,DELETE_YN
                ,REG_DT
                ,REG_ID
            ) VALUES (
                 #{programSubSno}
                ,#{festivityId}
                ,#{programSno}
                ,#{title}
                ,#{memo}
                ,#{leaderYn}
                ,#{orderCnt}
                ,#{atchFileId}
                ,#{useYn}
                ,'N'
                ,NOW()
                ,#{regId}
                     )
        ]]>
    </insert>
    <update id="updateProgramSub">
        UPDATE WJ_PROGRAM_SUB SET
             PROGRAM_SUB_SNO = #{programSubSno}
            ,FESTIVITY_ID = #{festivityId}
            ,PROGRAM_SNO = #{programSno}
            ,TITLE = #{title}
            ,MEMO = #{memo}
            ,LEADER_YN = #{leaderYn}
            ,ORDER_CNT = #{orderCnt}
            ,ATCH_FILE_ID = #{atchFileId}
            ,USE_YN = #{useYn}
            ,MOD_DT = NOW()
            ,MOD_ID = #{modId}
        WHERE 1=1
        AND PROGRAM_SUB_SNO = #{programSubSno}
    </update>

    <update id="deleteProgramSub">
        UPDATE WJ_PROGRAM_SUB SET
            DELETE_YN = 'Y'
        WHERE 1=1
        AND PROGRAM_SUB_SNO = #{programSubSno}
    </update>
</mapper>