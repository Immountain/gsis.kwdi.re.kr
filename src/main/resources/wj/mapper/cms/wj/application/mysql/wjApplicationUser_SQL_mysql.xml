<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="WjApplicationUserDAO">

    <select id="selectApplicationUser"
            parameterType="wj.com.cms.wj.application.vo.WjApplicationUserVO"
            resultType="wj.com.cms.wj.application.vo.WjApplicationUserVO">
        SELECT
             AU.APPLICATION_USER_SNO
            ,AU.FESTIVITY_ID
            ,AU.APPLICATION_ID
            ,AU.USER_NM
            ,AU.USER_EMAIL
            ,AU.USER_PHONE
            ,AU.DELETE_YN
            ,AU.REG_DT
            ,AU.REG_IP
            ,AU.MOD_DT
            ,AU.MOD_IP
        FROM WJ_APPLICATION_USER AU
        WHERE 1=1
          AND AU.FESTIVITY_ID =#{festivityId}
    </select>
    <select id="selectApplicationUserTotalCount"
        parameterType="wj.com.cms.wj.application.vo.WjApplicationUserVO"
        resultType="int">
        SELECT COUNT(*) totcnt
        FROM WJ_APPLICATION_USER AU
        WHERE 1=1
        AND FESTIVITY_ID = #{festivityId}

    </select>
    <select id="selectApplicationUserList"
        parameterType="wj.com.cms.wj.application.vo.WjApplicationUserVO"
        resultType="wj.com.cms.wj.application.vo.WjApplicationUserVO">
        SELECT
             AU.FESTIVITY_ID
            ,AU.APPLICATION_ID
            ,AU.APPLICATION_GB
            ,AU.APPLICATION_NM
            ,AU.APPLICATION_CONTENT
            ,AU.APPLICATION_MEMO
            ,AU.APPLICATION_STR_DT
            ,AU.APPLICATION_ENT_DT
            ,AU.USE_YN
            ,AU.REG_ID
            ,AU.REG_DT
            ,AU.MOD_ID
            ,AU.MOD_DT
        FROM WJ_APPLICATION_USER AU
        WHERE 1=1
        AND FESTIVITY_ID = #{festivityId}
        order by AU.REG_DT desc
    </select>

    <insert id="insertApplicationUser">
        <![CDATA[
            INSERT INTO WJ_APPLICATION_USER(
                 APPLICATION_USER_SNO
                ,FESTIVITY_ID
                ,APPLICATION_ID
                ,USER_NM
                ,USER_EMAIL
                ,USER_PHONE
                ,DELETE_YN
                ,REG_DT
                ,REG_IP
            ) VALUES (
                 #{applicationUserSno}
                ,#{festivityId}
                ,#{applicationId}
                ,#{userNm}
                ,#{userEmail}
                ,#{userPhone}
                ,'N'
                ,NOW()
                ,#{regIp}
                     )
        ]]>
    </insert>
    <update id="updateApplicationUser">
        UPDATE WJ_APPLICATION_USER SET
             APPLICATION_USER_SNO = #{applicationUserSno}
            ,FESTIVITY_ID = #{festivityId}
            ,APPLICATION_ID = #{applicationId}
            ,USER_NM = #{userNm}
            ,USER_EMAIL = #{userEmail}
            ,USER_PHONE = #{userPhone}
            ,MOD_DT = NOW()
            ,MOD_IP = #{modIp}
    </update>
</mapper>