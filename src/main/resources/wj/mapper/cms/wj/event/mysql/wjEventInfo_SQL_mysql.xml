<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="WjEventInfoDAO">

    <select id="selectEventInfo"
            parameterType="wj.com.cms.wj.event.vo.WjEventInfoVO"
            resultType="wj.com.cms.wj.event.vo.WjEventInfoVO">
        SELECT
             EI.EVENT_ID
            ,EI.EVENT_STR_DAY
            ,EI.EVENT_STR_TIME
            ,EI.EVENT_END_DAY
            ,EI.EVENT_END_TIME
            ,EI.ATCH_FILE_ID
            ,EI.USE_YN
            ,EI.DELETE_YN
            ,EI.REG_ID
            ,EI.REG_DT
            ,EI.MOD_ID
            ,EI.MOD_DT
        FROM WJ_EVENT_INFO EI
        WHERE 1=1
          AND EI.EVENT_ID =#{eventId}
    </select>
    <select id="selectEventInfoTotalCount"
        parameterType="wj.com.cms.wj.event.vo.WjEventInfoVO"
        resultType="int">
        SELECT COUNT(*) totcnt
        FROM WJ_EVENT_INFO EI
        WHERE 1=1
        AND EI.DELETE_YN = 'N'
        <if test="searchKeyword != null and searchKeyword != ''">
            <if test="searchCondition == 0">AND
                EI.EVENT_ID LIKE CONCAT('%' , #{searchKeyword}, '%')
            </if>
        </if>
    </select>
    <select id="selectEventInfoList"
        parameterType="wj.com.cms.wj.event.vo.WjEventInfoVO"
        resultType="wj.com.cms.wj.event.vo.WjEventInfoVO">
        SELECT
             EI.EVENT_ID
            ,EI.EVENT_STR_DAY
            ,EI.EVENT_STR_TIME
            ,EI.EVENT_END_DAY
            ,EI.EVENT_END_TIME
            ,EI.ATCH_FILE_ID
            ,EI.USE_YN
            ,EI.DELETE_YN
            ,EI.REG_ID
            ,EI.REG_DT
            ,EI.MOD_ID
            ,EI.MOD_DT
        FROM WJ_EVENT_INFO EI
        WHERE 1=1
        AND EI.DELETE_YN = 'N'
        <if test="searchKeyword != null and searchKeyword != ''">
            <if test="searchCondition == 0">AND
                EI.EVENT_ID LIKE CONCAT('%' , #{searchKeyword}, '%')
            </if>
        </if>
        order by EI.REG_DT desc
        LIMIT #{recordCountPerPage} OFFSET #{firstIndex}
    </select>

    <insert id="insertEventInfo">
        <![CDATA[
            INSERT INTO WJ_EVENT_INFO(
                 EVENT_ID
                ,EVENT_STR_DAY
                ,EVENT_STR_TIME
                ,EVENT_END_DAY
                ,EVENT_END_TIME
                ,ATCH_FILE_ID
                ,USE_YN
                ,DELETE_YN
                ,REG_ID
                ,REG_DT
            ) VALUES (
                 #{eventId}
                ,REPLACE(#{eventStrDay},'-','')
                ,REPLACE(#{eventStrTime},':','')
                ,REPLACE(#{eventEndDay},'-','')
                ,REPLACE(#{eventEndTime},':','')
                ,#{atchFileId}
                ,#{useYn}
                ,'N'
                ,#{regId}
                ,NOW()
                     )
        ]]>
    </insert>
    <update id="updateEventInfo">
        UPDATE WJ_EVENT_INFO SET
             EVENT_ID = #{eventId}
            ,EVENT_STR_DAY = REPLACE(#{eventStrDay},'-','')
            ,EVENT_STR_TIME = #{eventStrTime}
            ,EVENT_END_DAY = REPLACE(#{eventEndDay},'-','')
            ,EVENT_END_TIME = #{eventEndTime}
            ,ATCH_FILE_ID = #{atchFileId}
            ,USE_YN = #{useYn}
            ,MOD_ID = #{modId}
            ,MOD_DT = NOW()
        WHERE 1=1
        AND EVENT_ID = #{eventId}
    </update>

    <update id="deleteEventInfo">
        UPDATE WJ_EVENT_INFO SET

            DELETE_YN = 'Y'
        WHERE 1=1
        AND EVENT_ID = #{eventId}
    </update>
</mapper>