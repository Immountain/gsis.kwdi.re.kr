<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="WjStatsReportDAO">

    <select id="selectStatsReport"
            parameterType="wj.com.cms.wj.stats.vo.WjStatsReportVO"
            resultType="wj.com.cms.wj.stats.vo.WjStatsReportVO">
        SELECT
             SR.REPORT_SNO
            ,SR.COUNTRY_GB
            ,SR.COUNTRY_CODE
            ,SR.AREA_CODE
            ,SR.TITLE
            ,SR.ESTABLISH_YEAR
            ,SR.MEMBERSHIP
            ,SR.TEMP1
            ,SR.TEMP2
            ,SR.TEMP3
            ,SR.TEMP4
            ,SR.TEMP5
            ,SR.USE_YN
            ,SR.DELETE_YN
            ,SR.REG_DT
            ,SR.REG_ID
            ,SR.MOD_DT
            ,SR.MOD_ID
        FROM WJ_STATS_REPORT SR
        WHERE 1=1
          AND SR.REPORT_SNO =#{reportSno}
          AND SR.DELETE_YN = 'N'
    </select>
    <select id="selectStatsReportTotalCount"
        parameterType="wj.com.cms.wj.stats.vo.WjStatsReportVO"
        resultType="int">
        SELECT COUNT(*) totcnt
        FROM WJ_STATS_REPORT SR
        WHERE 1=1
        AND SR.DELETE_YN = 'N'
<!--        <if test="searchCondition == 0">AND-->
<!--            FI.FESTIVITY_ID LIKE CONCAT('%' , #{searchKeyword}, '%')-->
<!--        </if>-->
<!--        <if test="searchCondition == 1">AND-->
<!--            FI.FESTIVITY_NM LIKE CONCAT('%' , #{searchKeyword}, '%')-->
<!--        </if>-->
    </select>
    <select id="selectStatsReportList"
        parameterType="wj.com.cms.wj.stats.vo.WjStatsReportVO"
        resultType="wj.com.cms.wj.stats.vo.WjStatsReportVO">
        SELECT
             SR.REPORT_SNO
            ,SR.COUNTRY_GB
            ,SR.COUNTRY_CODE
            ,SR.AREA_CODE
            ,SR.TITLE
            ,SR.ESTABLISH_YEAR
            ,SR.MEMBERSHIP
            ,SR.TEMP1
            ,SR.TEMP2
            ,SR.TEMP3
            ,SR.TEMP4
            ,SR.TEMP5
            ,SR.USE_YN
            ,SR.DELETE_YN
            ,SR.REG_DT
            ,SR.REG_ID
            ,SR.MOD_DT
            ,SR.MOD_ID
        FROM WJ_STATS_REPORT SR
        WHERE 1=1
            AND SR.DELETE_YN = 'N'
<!--        <if test="searchCondition == 0">AND-->
<!--            FI.FESTIVITY_ID LIKE CONCAT('%' , #{searchKeyword}, '%')-->
<!--        </if>-->
<!--        <if test="searchCondition == 1">AND-->
<!--            FI.FESTIVITY_NM LIKE CONCAT('%' , #{searchKeyword}, '%')-->
<!--        </if>-->
        order by SR.REG_DT desc
        LIMIT #{recordCountPerPage} OFFSET #{firstIndex}
    </select>

    <insert id="insertStatsReport">
        <![CDATA[
            INSERT INTO WJ_STATS_REPORT(
                 REPORT_SNO
                ,COUNTRY_GB
                ,COUNTRY_CODE
                ,AREA_CODE
                ,TITLE
                ,ESTABLISH_YEAR
                ,MEMBERSHIP
                ,TEMP1
                ,TEMP2
                ,TEMP3
                ,TEMP4
                ,TEMP5
                ,USE_YN
                ,DELETE_YN
                ,REG_DT
                ,REG_ID

            ) VALUES (
                 #{reportSno}
                ,#{countryGb}
                ,#{countryCode}
                ,#{areaCode}
                ,#{title}
                ,#{establishYear}
                ,#{membership}
                ,#{temp1}
                ,#{temp2}
                ,#{temp3}
                ,#{temp4}
                ,#{temp5}
                ,#{useYn}
                ,'N'
                ,NOW()
                ,#{regId}
                     )
        ]]>
    </insert>
    <update id="updateStatsReport">
        UPDATE WJ_STATS_REPORT SET
             REPORT_SNO = #{reportSno}
            ,COUNTRY_GB = #{countryGb}
            ,COUNTRY_CODE = #{countryCode}
            ,AREA_CODE = #{areaCode}
            ,TITLE = #{title}
            ,ESTABLISH_YEAR = REPLACE(#{establishYear},"-","")
            ,MEMBERSHIP = #{membership}
            ,TEMP1 = #{temp1}
            ,TEMP2 = #{temp2}
            ,TEMP3 = #{temp3}
            ,TEMP4 = #{temp4}
            ,TEMP5 = #{temp5}
            ,USE_YN = #{useYn}
            ,MOD_DT = NOW()
            ,MOD_ID = #{modId}
        WHERE 1=1
        AND REPORT_SNO = #{reportSno}
    </update>

    <update id="deleteStatsReport">
        UPDATE WJ_STATS_REPORT SET
            DELETE_YN = 'Y'
        WHERE 1=1
        AND REPORT_SNO = #{reportSno}
    </update>
</mapper>